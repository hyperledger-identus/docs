<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-tutorials docs-version-current docs-doc-page docs-doc-id-dids/update" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.4.0">
<title data-rh="true">Update DID | Hyperledger Identus</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://hyperledger.github.io/identus-docs/tutorials/dids/update"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-tutorials-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-tutorials-current"><meta data-rh="true" property="og:title" content="Update DID | Hyperledger Identus"><meta data-rh="true" name="description" content="PRISM DID method allows DID Controller to update the content of the DID document by constructing a DID update-operation."><meta data-rh="true" property="og:description" content="PRISM DID method allows DID Controller to update the content of the DID document by constructing a DID update-operation."><link data-rh="true" rel="icon" href="/identus-docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://hyperledger.github.io/identus-docs/tutorials/dids/update"><link data-rh="true" rel="alternate" href="https://hyperledger.github.io/identus-docs/tutorials/dids/update" hreflang="en"><link data-rh="true" rel="alternate" href="https://hyperledger.github.io/identus-docs/tutorials/dids/update" hreflang="x-default"><link rel="stylesheet" href="/identus-docs/assets/css/styles.7aa07c05.css">
<script src="/identus-docs/assets/js/runtime~main.a65a7890.js" defer="defer"></script>
<script src="/identus-docs/assets/js/main.ac942653.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/identus-docs/"><div class="navbar__logo"><img src="/identus-docs/img/identus-navbar-light.png" alt=" Identus logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/identus-docs/img/identus-navbar-light.png" alt=" Identus logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/identus-docs/docs/getting-started">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/identus-docs/tutorials/">Tutorials</a><a class="navbar__item navbar__link" href="/identus-docs/adrs/">ADRs</a><a class="navbar__item navbar__link" href="/identus-docs/agent-api/">Agent API</a><div class="navbar__item dropdown dropdown--hoverable"><a aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link" href="/identus-docs/tutorials/dids/update">SDKs</a><ul class="dropdown__menu"><li><a href="https://hyperledger.github.io/identus-edge-agent-sdk-swift/documentation/edgeagentsdk/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Edge Agent SDK Swift<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a class="dropdown__link" href="/identus-docs/identus-edge-agent-sdk-ts/sdk">Edge Agent SDK Typescript</a></li><li><a href="https://hyperledger.github.io/identus-edge-agent-sdk-kmp/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Edge Agent SDK Kotlin Multiplatform<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://github.com/input-output-hk/prism-did-method-spec/blob/main/w3c-spec/PRISM-method.md" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">PRISM DID Spec<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/identus-docs/tutorials/">Tutorials</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/identus-docs/tutorials/connections/connection">Connections</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/identus-docs/tutorials/category/credentials">Credentials</a><button aria-label="Expand sidebar category &#x27;Credentials&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/identus-docs/tutorials/category/dids">DIDs</a><button aria-label="Collapse sidebar category &#x27;DIDs&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/identus-docs/tutorials/dids/create">Create DID</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/identus-docs/tutorials/dids/update">Update DID</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/identus-docs/tutorials/dids/publish">Publish DID</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/identus-docs/tutorials/dids/deactivate">Deactivate DID</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/identus-docs/tutorials/category/schemas">Schemas</a><button aria-label="Expand sidebar category &#x27;Schemas&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/identus-docs/tutorials/category/credential-definition">Credential Definition</a><button aria-label="Expand sidebar category &#x27;Credential Definition&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/identus-docs/tutorials/category/secret-management">Secret Management</a><button aria-label="Expand sidebar category &#x27;Secret Management&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/identus-docs/tutorials/webhooks/webhook">Webhooks</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/identus-docs/tutorials/multitenancy/tenant-onboarding">Multi-Tenancy</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/identus-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/identus-docs/tutorials/category/dids"><span itemprop="name">DIDs</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Update DID</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Update DID</h1>
<p>PRISM DID method allows <a href="/identus-docs/docs/concepts/glossary#did-controller">DID Controller</a> to update the content of the <a href="/identus-docs/docs/concepts/glossary#did-document">DID document</a> by constructing a DID update-operation.
The update-operation describes the update action on the DID document.
For example, DID Controller can add a new key to the DID document by constructing an update-operation containing the <code>AddKeyAction</code>.
It is also possible for DID Controller to compose multiple actions in the same update-operation.
The <a href="https://github.com/input-output-hk/prism-did-method-spec/blob/main/w3c-spec/PRISM-method.md#update-did" target="_blank" rel="noopener noreferrer">PRISM DID method - Update DID section</a> includes a complete list of supported update actions.
The PRISM DID method only allows published <a href="/identus-docs/docs/concepts/glossary#decentralized-identifier">DID</a> to be updated.</p>
<p>When updating a DID, each operation is connected through cryptography,
forming a sequence of operations known as the lineage.
It&#x27;s important to note that the lineage should not have any forks,
meaning that the operations should follow a single, uninterrupted path.
Only the operations within the valid lineage are considered when updating the data on
the DID document, while any operations on a forked lineage are disregarded and discarded by the protocol.</p>
<p>Please refer to <a href="https://github.com/input-output-hk/prism-did-method-spec/blob/main/w3c-spec/PRISM-method.md#processing-of-updatedidoperations" target="_blank" rel="noopener noreferrer">PRISM DID method - processing of update operation</a> for more detail about how a DID update-operation is processed.
It has an important implication on how the operation lineage is determined.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="roles">Roles<a class="hash-link" aria-label="Direct link to Roles" title="Direct link to Roles" href="/identus-docs/tutorials/dids/update#roles">​</a></h2>
<ol>
<li>DID Controller is the organization or individual who has control of the DID.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites" href="/identus-docs/tutorials/dids/update#prerequisites">​</a></h2>
<ol>
<li>DID Controller Cloud Agent is up and running</li>
<li>DID Controller has a DID created by the Cloud Agent (see <a href="/identus-docs/tutorials/dids/create">Create DID</a>)</li>
<li>DID Controller has a DID published to the blockchain (see <a href="/identus-docs/tutorials/dids/publish">Publish DID</a>)</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview" href="/identus-docs/tutorials/dids/update#overview">​</a></h2>
<p>The Cloud Agent allows the DID Controller to update the DID easily. This update mechanism is implementation specific and links the DID update-operation from the last confirmed operation observed on the blockchain.</p>
<p>When updating a DID, there is a waiting period for the update to be confirmed on the blockchain.
If the DID Controller updates the DID before the previous update is confirmed,
it can create a situation where the sequence of updates splits into two separate paths,
which is not allowed according to the protocol. This happens because the Cloud Agent connects
the update operation to the latest confirmed update. Once the pending update operation is confirmed,
any other pending operation that does not link to the latest confirmed operation will be discarded.
The subsequent updates continuing from that operation will also be discarded.
However, the Cloud Agent has a safeguard in place to prevent this issue by rejecting
multiple updates submitted on the same DID while previous updates are still being processed.</p>
<p>Please refer to the <code>SECURE_DEPTH</code> parameter in <a href="https://github.com/input-output-hk/prism-did-method-spec/blob/main/w3c-spec/PRISM-method.md#versioning-and-protocol-parameters" target="_blank" rel="noopener noreferrer">PRISM method - protocol parameters</a> for the number of confirmation blocks.
At the time of writing, this number is 112 blocks.</p>
<p>This example shows the DID update capability on the Cloud Agent and the steps to verify that the update has been confirmed and applied.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="endpoints">Endpoints<a class="hash-link" aria-label="Direct link to Endpoints" title="Direct link to Endpoints" href="/identus-docs/tutorials/dids/update#endpoints">​</a></h2>
<p>The example uses the following endpoints</p>
<table><thead><tr><th>Endpoint</th><th>Description</th><th>Role</th></tr></thead><tbody><tr><td><a href="/identus-docs/agent-api/#tag/DID-Registrar/operation/updateManagedDid"><code>POST /did-registrar/dids/{didRef}/updates</code></a></td><td>Update a PRISM DID</td><td>DID Controller</td></tr><tr><td><a href="/identus-docs/agent-api/#tag/DID/operation/getDid"><code>GET /dids/{didRef}</code></a></td><td>Resolve a DID to DID document representation</td><td>DID Controller</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="did-controller-interactions">DID Controller interactions<a class="hash-link" aria-label="Direct link to DID Controller interactions" title="Direct link to DID Controller interactions" href="/identus-docs/tutorials/dids/update#did-controller-interactions">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-check-the-current-state-of-the-did-document">1. Check the current state of the DID document<a class="hash-link" aria-label="Direct link to 1. Check the current state of the DID document" title="Direct link to 1. Check the current state of the DID document" href="/identus-docs/tutorials/dids/update#1-check-the-current-state-of-the-did-document">​</a></h3>
<p>Given the DID Controller has a DID on the Cloud Agent and that DID is published, he can resolve the DID document using short-form DID.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl --location --request GET &#x27;http://localhost:8080/cloud-agent/dids/{didRef}&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--header &quot;apikey: $API_KEY&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--header &#x27;Accept: */*&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Example DID document response (some fields omitted for readability)</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;@context&quot;: &quot;https://w3id.org/did-resolution/v1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;didDocument&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;@context&quot;: [&quot;https://www.w3.org/ns/did/v1&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;verificationMethod&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;controller&quot;: &quot;did:prism:4262377859267f308a06ec6acf211fbe4d6745aa9e637e04548771169616fb86&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;id&quot;: &quot;did:prism:4262377859267f308a06ec6acf211fbe4d6745aa9e637e04548771169616fb86#key-1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;publicKeyJwk&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;crv&quot;: &quot;secp256k1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;kty&quot;: &quot;EC&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;x&quot;: &quot;biEpgXMrmKMghF8LsXbIR0VDyIO31mnPkbJBpGDYH1g&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;y&quot;: &quot;0YLIMfxY0_3J8Db6W0I1wcHZG3vRCRndNEnVn4h2V7Y&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;type&quot;: &quot;EcdsaSecp256k1VerificationKey2019&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;didDocumentMetadata&quot;: {...},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;didResolutionMetadata&quot;: {...}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>verificationMethod</code> in the DID document only shows one public key called <code>key-1</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-add-a-new-key-and-remove-the-existing-key">2. Add a new key and remove the existing key<a class="hash-link" aria-label="Direct link to 2. Add a new key and remove the existing key" title="Direct link to 2. Add a new key and remove the existing key" href="/identus-docs/tutorials/dids/update#2-add-a-new-key-and-remove-the-existing-key">​</a></h3>
<p>The current DID document contains a key called <code>key-1</code>.
The DID Controller wishes to remove that key and add a new key called <code>key-2</code></p>
<p>The DID Controller submits a DID update request to <code>POST /did-registrar/dids/{didRef}/updates</code>.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl --location --request POST &#x27;http://localhost:8080/cloud-agent/did-registrar/dids/did:prism:4262377859267f308a06ec6acf211fbe4d6745aa9e637e04548771169616fb86/updates&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--header &#x27;Content-Type: application/json&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--header &#x27;Accept: application/json&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--header &quot;apikey: $API_KEY&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--data-raw &#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;actions&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;actionType&quot;: &quot;REMOVE_KEY&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;removeKey&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;id&quot;: &quot;key-1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;actionType&quot;: &quot;ADD_KEY&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;addKey&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;id&quot;: &quot;key-2&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;purpose&quot;: &quot;authentication&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;curve&quot;: &quot;secp256k1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Under the hood, the Cloud Agent constructs the DID update-operation from the last confirmed operation observed on the blockchain.
The DID Controller should receive a response about the scheduled operation, waiting for confirmation on the blockchain.</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;scheduledOperation&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;didRef&quot;: &quot;did:prism:4262377859267f308a06ec6acf211fbe4d6745aa9e637e04548771169616fb86&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;id&quot;: &quot;cb61cff083e27e2f8bc35b0e561780dc027c4f0072d2a2e478b2e0f26e3783b0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-wait-for-the-confirmation-and-observe-the-change-on-the-did-document">3. Wait for the confirmation and observe the change on the DID document<a class="hash-link" aria-label="Direct link to 3. Wait for the confirmation and observe the change on the DID document" title="Direct link to 3. Wait for the confirmation and observe the change on the DID document" href="/identus-docs/tutorials/dids/update#3-wait-for-the-confirmation-and-observe-the-change-on-the-did-document">​</a></h3>
<p>When the DID Controller tries to resolve the DID again using the example in Step 1,
the content might remain the same because the operation still needs to be confirmed and applied.</p>
<p>The DID Controller keeps polling this endpoint until the new key, <code>key-2</code>, gets observed.</p>
<p>Example response of updated DID document (some fields omitted for readability)</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;@context&quot;: &quot;https://w3id.org/did-resolution/v1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;didDocument&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;@context&quot;: [&quot;https://www.w3.org/ns/did/v1&quot;],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;verificationMethod&quot;: [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;controller&quot;: &quot;did:prism:4262377859267f308a06ec6acf211fbe4d6745aa9e637e04548771169616fb86&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;id&quot;: &quot;did:prism:4262377859267f308a06ec6acf211fbe4d6745aa9e637e04548771169616fb86#key-2&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;publicKeyJwk&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;crv&quot;: &quot;secp256k1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;kty&quot;: &quot;EC&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;x&quot;: &quot;sg5X06yRDNaW2YcuMuOPwrDPp_vqOtKng0hMHxaME10&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    &quot;y&quot;: &quot;uAKJanSsNoC_bcL4YS93qIqu_Qwdsr_80DzRTzI8RLU&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                &quot;type&quot;: &quot;EcdsaSecp256k1VerificationKey2019&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;didDocumentMetadata&quot;: {...},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;didResolutionMetadata&quot;: {...}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>A new key, called <code>key-2</code>, gets observed, and <code>key-1</code>, now removed, has disappeared from the <code>verificationMethod</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="future-work">Future work<a class="hash-link" aria-label="Direct link to Future work" title="Direct link to Future work" href="/identus-docs/tutorials/dids/update#future-work">​</a></h2>
<p>The example only shows the case of a successful update.
In case of failure, the Cloud Agent will provide the capability to retrieve the low-level operation status and failure detail in the future.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/identus-docs/tutorials/dids/create"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Create DID</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/identus-docs/tutorials/dids/publish"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Publish DID</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a class="table-of-contents__link toc-highlight" href="/identus-docs/tutorials/dids/update#roles">Roles</a></li><li><a class="table-of-contents__link toc-highlight" href="/identus-docs/tutorials/dids/update#prerequisites">Prerequisites</a></li><li><a class="table-of-contents__link toc-highlight" href="/identus-docs/tutorials/dids/update#overview">Overview</a></li><li><a class="table-of-contents__link toc-highlight" href="/identus-docs/tutorials/dids/update#endpoints">Endpoints</a></li><li><a class="table-of-contents__link toc-highlight" href="/identus-docs/tutorials/dids/update#did-controller-interactions">DID Controller interactions</a><ul><li><a class="table-of-contents__link toc-highlight" href="/identus-docs/tutorials/dids/update#1-check-the-current-state-of-the-did-document">1. Check the current state of the DID document</a></li><li><a class="table-of-contents__link toc-highlight" href="/identus-docs/tutorials/dids/update#2-add-a-new-key-and-remove-the-existing-key">2. Add a new key and remove the existing key</a></li><li><a class="table-of-contents__link toc-highlight" href="/identus-docs/tutorials/dids/update#3-wait-for-the-confirmation-and-observe-the-change-on-the-did-document">3. Wait for the confirmation and observe the change on the DID document</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/identus-docs/tutorials/dids/update#future-work">Future work</a></li></ul></div></div></div></div></main></div></div></div><div class="container"><footer class="footer_J6tW"><svg xmlns="http://www.w3.org/2000/svg" width="145" height="38" fill="none"></svg><span class="copyright_C6JK">Hyperledger Identus CC BY 4.0</span></footer></div></div>
</body>
</html>