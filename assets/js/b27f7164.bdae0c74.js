"use strict";(globalThis.webpackChunkidentus_documentation_portal=globalThis.webpackChunkidentus_documentation_portal||[]).push([[8570],{4865:(e,n,s)=>{s.d(n,{A:()=>p});var i=s(96540),r=s(34164),t=s(17559),d=s(23104),a=s(47751),c=s(92303);const o={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var l=s(74848);function h({className:e,block:n,selectedValue:s,selectValue:i,tabValues:t}){const a=[],{blockElementScrollPositionUntilNextRender:c}=(0,d.a_)(),h=e=>{const n=e.currentTarget,r=a.indexOf(n),d=t[r].value;d!==s&&(c(n),i(d))},u=e=>{let n=null;switch(e.key){case"Enter":h(e);break;case"ArrowRight":{const s=a.indexOf(e.currentTarget)+1;n=a[s]??a[0];break}case"ArrowLeft":{const s=a.indexOf(e.currentTarget)-1;n=a[s]??a[a.length-1];break}}n?.focus()};return(0,l.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":n},e),children:t.map(({value:e,label:n,attributes:i})=>(0,l.jsx)("li",{role:"tab",tabIndex:s===e?0:-1,"aria-selected":s===e,ref:e=>{a.push(e)},onKeyDown:u,onClick:h,...i,className:(0,r.A)("tabs__item",o.tabItem,i?.className,{"tabs__item--active":s===e}),children:n??e},e))})}function u({lazy:e,children:n,selectedValue:s}){const t=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=t.find(e=>e.props.value===s);return e?(0,i.cloneElement)(e,{className:(0,r.A)("margin-top--md",e.props.className)}):null}return(0,l.jsx)("div",{className:"margin-top--md",children:t.map((e,n)=>(0,i.cloneElement)(e,{key:n,hidden:e.props.value!==s}))})}function f(e){const n=(0,a.u)(e);return(0,l.jsxs)("div",{className:(0,r.A)(t.G.tabs.container,"tabs-container",o.tabList),children:[(0,l.jsx)(h,{...n,...e}),(0,l.jsx)(u,{...n,...e})]})}function p(e){const n=(0,c.default)();return(0,l.jsx)(f,{...e,children:(0,a.v)(e.children)},String(n))}},10121:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/issue-flow.jwt-11d234a161e3e9a34314bfaa4ca630f3.png"},19365:(e,n,s)=>{s.r(n),s.d(n,{default:()=>d});s(96540);var i=s(34164);const r={tabItem:"tabItem_Ymn6"};var t=s(74848);function d({children:e,hidden:n,className:s}){return(0,t.jsx)("div",{role:"tabpanel",className:(0,i.A)(r.tabItem,s),hidden:n,children:e})}},28453:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>a});var i=s(96540);const r={},t=i.createContext(r);function d(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),i.createElement(t.Provider,{value:n},e.children)}},47751:(e,n,s)=>{s.d(n,{u:()=>f,v:()=>o});var i=s(96540),r=s(56347),t=s(205),d=s(57485),a=s(70679),c=s(31682);function o(e){return i.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,i.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function l(e){const{values:n,children:s}=e;return(0,i.useMemo)(()=>{const e=n??function(e){return o(e).map(({props:{value:e,label:n,attributes:s,default:i}})=>({value:e,label:n,attributes:s,default:i}))}(s);return function(e){const n=(0,c.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,s])}function h({value:e,tabValues:n}){return n.some(n=>n.value===e)}function u({queryString:e=!1,groupId:n}){const s=(0,r.W6)(),t=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,d.aZ)(t),(0,i.useCallback)(e=>{if(!t)return;const n=new URLSearchParams(s.location.search);n.set(t,e),s.replace({...s.location,search:n.toString()})},[t,s])]}function f(e){const{defaultValue:n,queryString:s=!1,groupId:r}=e,d=l(e),[c,o]=(0,i.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!h({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const s=n.find(e=>e.default)??n[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:n,tabValues:d})),[f,p]=u({queryString:s,groupId:r}),[j,x]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[s,r]=(0,a.Dv)(n);return[s,(0,i.useCallback)(e=>{n&&r.set(e)},[n,r])]}({groupId:r}),m=(()=>{const e=f??j;return h({value:e,tabValues:d})?e:null})();(0,t.A)(()=>{m&&o(m)},[m]);return{selectedValue:c,selectValue:(0,i.useCallback)(e=>{if(!h({value:e,tabValues:d}))throw new Error(`Can't select invalid tab value=${e}`);o(e),p(e),x(e)},[p,x,d]),tabValues:d}}},49652:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>f,frontMatter:()=>c,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"cloud-agent/docs/docusaurus/credentials/didcomm/issue","title":"Issue credentials (DIDComm)","description":"In the Identus Platform, the Issue Credentials Protocol allows you","source":"@site/cloud-agent/docs/docusaurus/credentials/didcomm/issue.md","sourceDirName":"cloud-agent/docs/docusaurus/credentials/didcomm","slug":"/cloud-agent/docs/docusaurus/credentials/didcomm/issue","permalink":"/docs/cloud-agent/docs/docusaurus/credentials/didcomm/issue","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"developersSidebar","previous":{"title":"Credentials","permalink":"/docs/category/credentials"},"next":{"title":"Issue credentials (Connectionless)","permalink":"/docs/cloud-agent/docs/docusaurus/credentials/connectionless/issue"}}');var r=s(74848),t=s(28453),d=s(4865),a=s(19365);const c={},o="Issue credentials (DIDComm)",l={},h=[{value:"Roles",id:"roles",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Overview",id:"overview",level:2},{value:"Endpoints",id:"endpoints",level:2},{value:"Issuer interactions",id:"issuer-interactions",level:2},{value:"Creating a Credential Offer",id:"creating-a-credential-offer",level:3},{value:"Sending the Offer to the Holder",id:"sending-the-offer-to-the-holder",level:3},{value:"Issuing the Credential",id:"issuing-the-credential",level:3},{value:"Holder interactions",id:"holder-interactions",level:2},{value:"Receiving the VC Offer",id:"receiving-the-vc-offer",level:3},{value:"Approving the VC Offer",id:"approving-the-vc-offer",level:3},{value:"Receiving the VC Credential",id:"receiving-the-vc-credential",level:3},{value:"Sequence diagram",id:"sequence-diagram",level:2}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"issue-credentials-didcomm",children:"Issue credentials (DIDComm)"})}),"\n",(0,r.jsxs)(n.p,{children:["In the Identus Platform, the ",(0,r.jsx)(n.a,{href:"/documentation/learn/glossary#issue-credential-protocol",children:"Issue Credentials Protocol"})," allows you\nto create, retrieve, and manage issued ",(0,r.jsx)(n.a,{href:"/documentation/learn/glossary#verifiable-credentials",children:"verifiable credentials (VCs)"}),"\nbetween a VC issuer and a VC holder."]}),"\n",(0,r.jsx)(n.h2,{id:"roles",children:"Roles"}),"\n",(0,r.jsx)(n.p,{children:"In the Issue Credentials Protocol, there are two roles:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["The ",(0,r.jsx)(n.a,{href:"/documentation/learn/glossary#issuer",children:"Issuer"})," is responsible for creating a new credential offer, sending it to a\nHolder, and issuing the VC once the offer is accepted."]}),"\n",(0,r.jsxs)(n.li,{children:["The ",(0,r.jsx)(n.a,{href:"/documentation/learn/glossary#holder",children:"Holder"})," is responsible for accepting a credential offer from an issuer and\nreceiving the VC."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"The Issuer and Holder interact with the Identus Cloud Agent API to perform the operations defined in the protocol."}),"\n",(0,r.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsx)(n.p,{children:"Before using the Issuing Credentials protocol, the following conditions must be present:"}),"\n",(0,r.jsxs)(d.A,{groupId:"vc-formats",children:[(0,r.jsx)(a.default,{value:"jwt",label:"JWT",children:(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Issuer and Holder Cloud Agents up and running"}),"\n",(0,r.jsxs)(n.li,{children:["A connection must be established between the Issuer and Holder Cloud Agents (\nsee ",(0,r.jsx)(n.a,{href:"/docs/cloud-agent/docs/docusaurus/connections/connection",children:"Connections"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["The Issuer must have a published PRISM DID, and the ",(0,r.jsx)(n.a,{href:"/documentation/learn/glossary#did-document",children:"DID document"})," must have at\nleast one ",(0,r.jsx)(n.code,{children:"assertionMethod"})," key for issuing credentials (see ",(0,r.jsx)(n.a,{href:"/docs/cloud-agent/docs/docusaurus/dids/create",children:"Create DID"}),"\nand ",(0,r.jsx)(n.a,{href:"/docs/cloud-agent/docs/docusaurus/dids/publish",children:"Publish DID"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["The Issuer must have created a VC schema as described ",(0,r.jsx)(n.a,{href:"/docs/cloud-agent/docs/docusaurus/schemas/create",children:"here"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["The Holder must have a PRISM DID, and the DID document must have at least one ",(0,r.jsx)(n.code,{children:"authentication"})," key for presenting the\nproof."]}),"\n"]})}),(0,r.jsx)(a.default,{value:"anoncreds",label:"AnonCreds",children:(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Issuer and Holder Cloud Agents up and running"}),"\n",(0,r.jsxs)(n.li,{children:["A connection must be established between the Issuer and Holder Cloud Agents (\nsee ",(0,r.jsx)(n.a,{href:"/docs/cloud-agent/docs/docusaurus/connections/connection",children:"Connections"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["The Issuer must have created an AnonCreds Credential Definition as\ndescribed ",(0,r.jsx)(n.a,{href:"/docs/cloud-agent/docs/docusaurus/credentialdefinition/create",children:"here"}),"."]}),"\n"]})}),(0,r.jsxs)(a.default,{value:"sdjwt",label:"SDJWT",children:[(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\ud83d\udccc ",(0,r.jsx)(n.strong,{children:"Note:"})," Currently we only support ",(0,r.jsx)(n.code,{children:"Ed25519"})," curve"]}),"\n"]}),(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Issuer and Holder Cloud Agents up and running"}),"\n",(0,r.jsxs)(n.li,{children:["A connection must be established between the Issuer and Holder Cloud Agents (\nsee ",(0,r.jsx)(n.a,{href:"/docs/cloud-agent/docs/docusaurus/connections/connection",children:"Connections"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["The Issuer must have a published PRISM DID, and the ",(0,r.jsx)(n.a,{href:"/documentation/learn/glossary#did-document",children:"DID document"})," must have at\nleast one ",(0,r.jsx)(n.code,{children:"assertionMethod"})," key for issuing credentials and the curve must be ",(0,r.jsx)(n.code,{children:"Ed25519"})," (\nsee ",(0,r.jsx)(n.a,{href:"/docs/cloud-agent/docs/docusaurus/dids/create",children:"Create DID"})," and ",(0,r.jsx)(n.a,{href:"/docs/cloud-agent/docs/docusaurus/dids/publish",children:"Publish DID"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["The Issuer must have created a VC schema as described ",(0,r.jsx)(n.a,{href:"/docs/cloud-agent/docs/docusaurus/schemas/create",children:"here"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["The Holder must have a PRISM DID, and the DID document must have at least one ",(0,r.jsx)(n.code,{children:"authentication"})," key for presenting the\nproof and the curve must be ",(0,r.jsx)(n.code,{children:"Ed25519"}),"."]}),"\n"]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"The protocol described is a VC issuance process between two Identus Cloud Agents, the Issuer and the Holder."}),"\n",(0,r.jsx)(n.p,{children:"The protocol consists of the following main parts:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["The Issuer creates a new credential offer using\nthe ",(0,r.jsx)(n.a,{href:"/documentation/reference/Cloud%20Agent%20API/identus-cloud-agent-api-reference/#tag/Issue-Credentials-Protocol/operation/createCredentialOffer",children:(0,r.jsx)(n.code,{children:"/issue-credentials/credential-offers"})}),"\nendpoint, which includes information such as the schema identifier and claims."]}),"\n",(0,r.jsxs)(n.li,{children:["The Holder can then retrieve the offer using\nthe ",(0,r.jsx)(n.a,{href:"/documentation/reference/Cloud%20Agent%20API/identus-cloud-agent-api-reference/#tag/Issue-Credentials-Protocol/operation/getCredentialRecords",children:(0,r.jsx)(n.code,{children:"/issue-credentials/records"})}),"\nendpoint and accept the offer using\nthe ",(0,r.jsx)(n.a,{href:"/documentation/reference/Cloud%20Agent%20API/identus-cloud-agent-api-reference/#tag/Issue-Credentials-Protocol/operation/acceptCredentialOffer",children:(0,r.jsx)(n.code,{children:"/issue-credentials/records/{recordId}/accept-offer"})}),"\nendpoint."]}),"\n",(0,r.jsxs)(n.li,{children:["The Issuer then uses\nthe ",(0,r.jsx)(n.a,{href:"/documentation/reference/Cloud%20Agent%20API/identus-cloud-agent-api-reference/#tag/Issue-Credentials-Protocol/operation/issueCredential",children:(0,r.jsx)(n.code,{children:"/issue-credentials/records/{recordId}/issue-credential"})}),"\nendpoint to issue the credential, which gets sent to the Holder via ",(0,r.jsx)(n.a,{href:"/documentation/learn/glossary#didcomm",children:"DIDComm"}),". The\nHolder receives the credential, and the protocol is complete."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"The claims provide specific information about the individual, such as their name or qualifications."}),"\n",(0,r.jsx)(n.p,{children:"This protocol is applicable in various real-life scenarios, such as educational credentialing, employment verification,\nand more.\nIn these scenarios, the Issuer could be a school, an employer, etc., and the Holder could be a student or an employee.\nThe VCs issued during this protocol could represent a diploma, a certificate of employment, etc."}),"\n",(0,r.jsx)(n.h2,{id:"endpoints",children:"Endpoints"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Endpoint"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Role"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/documentation/reference/Cloud%20Agent%20API/identus-cloud-agent-api-reference/#tag/Issue-Credentials-Protocol/operation/createCredentialOffer",children:(0,r.jsx)(n.code,{children:"/issue-credentials/credential-offers"})})}),(0,r.jsx)(n.td,{children:"This endpoint allows you to create a new credential offer"}),(0,r.jsx)(n.td,{children:"Issuer"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/documentation/reference/Cloud%20Agent%20API/identus-cloud-agent-api-reference/#tag/Issue-Credentials-Protocol/operation/getCredentialRecords",children:(0,r.jsx)(n.code,{children:"/issue-credentials/records"})})}),(0,r.jsx)(n.td,{children:"This endpoint allows you to retrieve a collection of all the existing credential records"}),(0,r.jsx)(n.td,{children:"Issuer, Holder"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/documentation/reference/Cloud%20Agent%20API/identus-cloud-agent-api-reference/#tag/Issue-Credentials-Protocol/operation/getCredentialRecord",children:(0,r.jsx)(n.code,{children:"/issue-credentials/records/{recordId}"})})}),(0,r.jsxs)(n.td,{children:["This endpoint allows you to retrieve a specific credential record by its ",(0,r.jsx)(n.code,{children:"id"})]}),(0,r.jsx)(n.td,{children:"Issuer, Holder"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/documentation/reference/Cloud%20Agent%20API/identus-cloud-agent-api-reference/#tag/Issue-Credentials-Protocol/operation/acceptCredentialOffer",children:(0,r.jsx)(n.code,{children:"/issue-credentials/records/{recordId}/accept-offer"})})}),(0,r.jsx)(n.td,{children:"This endpoint allows you to accept a credential offer"}),(0,r.jsx)(n.td,{children:"Holder"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.a,{href:"/documentation/reference/Cloud%20Agent%20API/identus-cloud-agent-api-reference/#tag/Issue-Credentials-Protocol/operation/issueCredential",children:(0,r.jsx)(n.code,{children:"/issue-credentials/records/{recordId}/issue-credential"})})}),(0,r.jsx)(n.td,{children:"This endpoint allows you to issue a VC for a specific credential record."}),(0,r.jsx)(n.td,{children:"Issuer"})]})]})]}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsxs)(n.p,{children:["Please check the full ",(0,r.jsx)(n.a,{href:"/documentation/reference/Cloud%20Agent%20API/identus-cloud-agent-api-reference",children:"Cloud Agent API"})," specification for more detailed information."]})}),"\n",(0,r.jsx)(n.h2,{id:"issuer-interactions",children:"Issuer interactions"}),"\n",(0,r.jsx)(n.p,{children:"This section describes the Issuer role's available interactions with the Cloud Agent."}),"\n",(0,r.jsx)(n.h3,{id:"creating-a-credential-offer",children:"Creating a Credential Offer"}),"\n",(0,r.jsxs)(n.p,{children:["To start the process, the issuer needs to create a credential offer.\nTo do this, make a ",(0,r.jsx)(n.code,{children:"POST"})," request to\nthe ",(0,r.jsx)(n.a,{href:"/documentation/reference/Cloud%20Agent%20API/identus-cloud-agent-api-reference/#tag/Issue-Credentials-Protocol/operation/createCredentialOffer",children:(0,r.jsx)(n.code,{children:"/issue-credentials/credential-offers"})}),"\nendpoint with a JSON payload that includes the following information:"]}),"\n",(0,r.jsxs)(d.A,{groupId:"vc-formats",children:[(0,r.jsxs)(a.default,{value:"jwt",label:"JWT",children:[(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"NOTE"}),": After v1.40.0 the API was changed to be compliant with VCDM 1.1 and group the JWT-VC properties in the object ",(0,r.jsx)(n.code,{children:"jwtVcPropertiesV1"})]}),(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"claims"})," (deprecated): The data stored in a verifiable credential. Claims get expressed in a key-value format. The\nclaims contain the data that the issuer attests to, such as name, address, date of birth, and so on."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"jwtVcPropertiesV1.claims"}),": The data stored in a verifiable credential. Claims get expressed in a key-value format.\nThe claims contain the data that the issuer attests to, such as name, address, date of birth, and so on."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"issuingDID"})," (deprecated): The DID referring to the issuer to issue this credential from."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"jwtVcPropertiesV1.issuingDID"}),": The DID referring to the issuer to issue this credential from."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"jwtVcPropertiesV1.issuingKid"}),": The key ID of the DID to sign the JWT VC."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"jwtVcPropertiesV1.validityPeriod"}),": The validity period of the JWT VC in seconds."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"connectionId"}),": The unique ID of the connection between the holder and the issuer to offer this credential over."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"schemaId"})," (deprecated): An optional field that, if specified, contains a valid URL to an existing VC schema."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"jwtVcPropertiesV1.credentialSchema.id"}),": The required field that, if specified, contains a valid URI to an existing\nVC schema."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"jwtVcPropertiesV1.credentialSchema.type"}),": The required field that must equal to ",(0,r.jsx)(n.code,{children:"JsonSchemaValidator2018"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"credentialFormat"}),": The format of the credential that will be issued - ",(0,r.jsx)(n.code,{children:"JWT"})," in this case. When not specified, the\ndefault value is ",(0,r.jsx)(n.code,{children:"JWT"}),"."]}),"\n"]}),(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"issuingDID"})," and ",(0,r.jsx)(n.code,{children:"connectionId"})," properties come from completing the pre-requisite steps listed above"]})}),(0,r.jsxs)(n.p,{children:["Once the request initiates, a new credential record for the issuer gets created with a unique ID. The state of this\nrecord is now ",(0,r.jsx)(n.code,{children:"OfferPending"}),"."]}),(0,r.jsxs)(d.A,{groupId:"api-versions",children:[(0,r.jsx)(a.default,{value:"deprecated",label:"Deprecated API",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'# Issuer POST request to create a new credential offer (deprecated, but still supported)\ncurl -X \'POST\' \\\n  \'http://localhost:8080/cloud-agent/issue-credentials/credential-offers\' \\\n    -H \'accept: application/json\' \\\n    -H \'Content-Type: application/json\' \\\n    -H "apikey: $API_KEY" \\\n    -d \'{\n          "connectionId": "9d075518-f97e-4f11-9d10-d7348a7a0fda",\n          "credentialFormat": "JWT",\n          "claims": {\n            "emailAddress": "alice@wonderland.com",\n            "givenName": "Alice",\n            "familyName": "Wonderland",\n            "dateOfIssuance": "2020-11-13T20:20:39+00:00",\n            "drivingLicenseID": "12345",\n            "drivingClass": 3\n          },\n          "issuingDID": "did:prism:9f847f8bbb66c112f71d08ab39930d468ccbfe1e0e1d002be53d46c431212c26",\n          "schemaId": "http://localhost:8080/cloud-agent/schema-registry/schemas/3f86a73f-5b78-39c7-af77-0c16123fa9c2"\n        }\'\n'})})}),(0,r.jsx)(a.default,{value:"current",label:"Current API",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'# Issuer POST request to create a new credential offer\ncurl -X \'POST\' \\\n  \'http://localhost:8080/cloud-agent/issue-credentials/credential-offers\' \\\n    -H \'accept: application/json\' \\\n    -H \'Content-Type: application/json\' \\\n    -H "apikey: $API_KEY" \\\n    -d \'{\n          "connectionId": "9d075518-f97e-4f11-9d10-d7348a7a0fda",\n          "credentialFormat": "JWT"\n          "jwtVcPropertiesV1": {\n            "claims": {\n               "emailAddress": "alice@wonderland.com",\n               "givenName": "Alice",\n               "familyName": "Wonderland",\n               "dateOfIssuance": "2020-11-13T20:20:39+00:00",\n               "drivingLicenseID": "12345",\n               "drivingClass": 3\n             },\n             "issuingDID": "did:prism:9f847f8bbb66c112f71d08ab39930d468ccbfe1e0e1d002be53d46c431212c26",\n             "credentialSchema": {\n                "id: "http://localhost:8080/cloud-agent/schema-registry/schemas/3f86a73f-5b78-39c7-af77-0c16123fa9c2",\n                "type": "JsonSchemaValidator2018"\n             }\n          }\n        }\'\n'})})})]})]}),(0,r.jsxs)(a.default,{value:"anoncreds",label:"AnonCreds",children:[(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"connectionId"}),": The unique ID of the connection between the holder and the issuer to offer this credential over."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"credentialFormat"}),": The format of the credential that will be issued - ",(0,r.jsx)(n.code,{children:"AnonCreds"})," in this case."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"claims"})," (deprecated): The data stored in a verifiable credential."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"anoncredsVcPropertiesV1.claims"}),': The data stored in a verifiable credential. AnonCreds claims get expressed in a\nflat, "string -> string", key-value pair format. The claims contain the data that the issuer attests to, such as\nname, address, date of birth, and so on.']}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"credentialDefinitionId"})," (deprecated): The unique ID of\nthe ",(0,r.jsx)(n.a,{href:"/docs/cloud-agent/docs/docusaurus/credentialdefinition/credential-definition",children:"credential definition"})," that has been created by the issuer\nas a prerequisite. Please refer to\nthe ",(0,r.jsx)(n.a,{href:"/docs/cloud-agent/docs/docusaurus/credentialdefinition/credential-definition",children:"Create AnonCreds Credential Definition"})," doc for details on\nhow to create a credential definition."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"anoncredsVcPropertiesV1.credentialDefinitionId"}),": The unique ID of the credential definition.","\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["If the credential definition was created via HTTP URL endpoint, then this credential definition will be referenced to\nthat credential via HTTP URL, and if this credential definition was created via DID URL endpoint, then it will be\nreferenced via DID URL, How to create credential definition for HTTP URL or DID URL is explained\nin ",(0,r.jsx)(n.a,{href:"/docs/cloud-agent/docs/docusaurus/credentialdefinition/create",children:"credential definition creation guide"})]})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"issuingDID"})," (deprecated): The DID referring to the issuer to issue this credential from"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"anoncredsVcPropertiesV1.issuingDID"}),": The DID referring to the issuer to issue this credential from","\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"connectionId"})," and ",(0,r.jsx)(n.code,{children:"credentialDefinitionId"})," properties come from completing the pre-requisite steps listed above"]})}),"\n"]}),"\n"]}),(0,r.jsxs)(n.p,{children:["Once the request initiates, a new credential record for the issuer gets created with a unique ID. The state of this\nrecord is now ",(0,r.jsx)(n.code,{children:"OfferPending"}),"."]}),(0,r.jsxs)(d.A,{groupId:"api-versions",children:[(0,r.jsx)(a.default,{value:"deprecated",label:"Deprecated API",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'# Issuer POST request to create a new credential offer\ncurl -X \'POST\' \\\n  \'http://localhost:8080/cloud-agent/issue-credentials/credential-offers\' \\\n    -H \'accept: application/json\' \\\n    -H \'Content-Type: application/json\' \\\n    -H "apikey: $API_KEY" \\\n    -d \'{\n          "connectionId": "9d075518-f97e-4f11-9d10-d7348a7a0fda",\n          "credentialFormat": "AnonCreds",\n          "claims": {\n            "emailAddress": "alice@wonderland.com",\n            "givenName": "Alice",\n            "familyName": "Wonderland",\n            "dateOfIssuance": "2020-11-13T20:20:39+00:00",\n            "drivingLicenseID": "12345",\n            "drivingClass": "3"\n          },\n          "issuingDID": "did:prism:9f847f8bbb66c112f71d08ab39930d468ccbfe1e0e1d002be53d46c431212c26",\n          "credentialDefinitionId": "5d737816-8fe8-3492-bfe3-1b3e2b67220b"\n        }\'\n'})})}),(0,r.jsx)(a.default,{value:"current",label:"Current API",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'# Issuer POST request to create a new credential offer\ncurl -X \'POST\' \\\n  \'http://localhost:8080/cloud-agent/issue-credentials/credential-offers\' \\\n    -H \'accept: application/json\' \\\n    -H \'Content-Type: application/json\' \\\n    -H "apikey: $API_KEY" \\\n    -d \'{\n          "connectionId": "9d075518-f97e-4f11-9d10-d7348a7a0fda",\n          "credentialFormat": "AnonCreds",\n          "anoncredsVcPropertiesV1": {\n             "claims": {\n               "emailAddress": "alice@wonderland.com",\n               "givenName": "Alice",\n               "familyName": "Wonderland",\n               "dateOfIssuance": "2020-11-13T20:20:39+00:00",\n               "drivingLicenseID": "12345",\n               "drivingClass": "3"\n             },\n             "issuingDID": "did:prism:9f847f8bbb66c112f71d08ab39930d468ccbfe1e0e1d002be53d46c431212c26",\n             "credentialDefinitionId": "5d737816-8fe8-3492-bfe3-1b3e2b67220b"\n          }\n        }\'\n'})})})]})]}),(0,r.jsxs)(a.default,{value:"sdjwt",label:"SDJWT",children:[(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"connectionId"}),": The unique ID of the connection between the holder and the issuer to offer this credential over."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"credentialFormat"}),": The format of the credential that will be issued - ",(0,r.jsx)(n.code,{children:"SDJWT"})," in this case."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"claims"})," (deprecated): The data stored in a verifiable credential. Claims get expressed in a key-value format. The\nclaims contain the data that the issuer attests to, such as name, address, date of birth, and so on."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"sdJwtVcPropertiesV1.claims"}),": The data stored in a verifiable credential."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"issuingDID"})," (deprecated): The DID referring to the issuer to issue this credential from"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"sdJwtVcPropertiesV1.issuingDID"}),": The DID referring to the issuer to issue this credential from"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"schemaId"})," (deprecated): An optional field that, if specified, contains a valid URL to an existing VC schema."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"sdJwtVcPropertiesV1.credentialSchema.id"}),": The required field that, if specified, contains a valid URI to an existing\nVC schema."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"sdJwtVcPropertiesV1.credentialSchema.type"}),": The required field that must equal to ",(0,r.jsx)(n.code,{children:"JsonSchemaValidator2018"})]}),"\n"]}),(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"issuingDID"})," and ",(0,r.jsx)(n.code,{children:"connectionId"})," properties come from completing the pre-requisite steps listed above"]})}),(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsxs)(n.p,{children:["Claims can also include the ",(0,r.jsx)(n.code,{children:"exp"})," Expiration Time attribute, which is part of JWT claims. ",(0,r.jsx)(n.code,{children:"exp"})," attribute is disclosable\nif specified and can have a value in epoch time (in seconds), indicating when the SDJWT credential expires for more\ndetails\n",(0,r.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/html/rfc7519#page-9",children:"RFC5719"})]})}),(0,r.jsxs)(n.p,{children:["Once the request initiates, a new credential record for the issuer gets created with a unique ID. The state of this\nrecord is now ",(0,r.jsx)(n.code,{children:"OfferPending"}),"."]}),(0,r.jsxs)(d.A,{groupId:"api-versions",children:[(0,r.jsx)(a.default,{value:"deprecated",label:"Deprecated API",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'# Issuer POST request to create a new credential offer\ncurl -X \'POST\' \\\n  \'http://localhost:8080/cloud-agent/issue-credentials/credential-offers\' \\\n    -H \'accept: application/json\' \\\n    -H \'Content-Type: application/json\' \\\n    -H "apikey: $API_KEY" \\\n    -d \'{\n          "connectionId": "9d075518-f97e-4f11-9d10-d7348a7a0fda",\n          "credentialFormat": "SDJWT",\n          "claims": {\n            "emailAddress": "alice@wonderland.com",\n            "givenName": "Alice",\n            "familyName": "Wonderland",\n            "dateOfIssuance": "2020-11-13T20:20:39+00:00",\n            "drivingLicenseID": "12345",\n            "drivingClass": 3,\n            "exp" : 1883000000\n          },\n          "issuingDID": "did:prism:9f847f8bbb66c112f71d08ab39930d468ccbfe1e0e1d002be53d46c431212c26",\n          "schemaId": "http://localhost:8080/cloud-agent/schema-registry/schemas/3f86a73f-5b78-39c7-af77-0c16123fa9c2"\n        }\'\n'})})}),(0,r.jsx)(a.default,{value:"current",label:"Current API",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'# Issuer POST request to create a new credential offer\ncurl -X \'POST\' \\\n  \'http://localhost:8080/cloud-agent/issue-credentials/credential-offers\' \\\n    -H \'accept: application/json\' \\\n    -H \'Content-Type: application/json\' \\\n    -H "apikey: $API_KEY" \\\n    -d \'{\n          "connectionId": "9d075518-f97e-4f11-9d10-d7348a7a0fda",\n          "credentialFormat": "SDJWT",\n          "sdJwtVcPropertiesV1": {\n             "claims": {\n               "emailAddress": "alice@wonderland.com",\n               "givenName": "Alice",\n               "familyName": "Wonderland",\n               "dateOfIssuance": "2020-11-13T20:20:39+00:00",\n               "drivingLicenseID": "12345",\n               "drivingClass": 3,\n               "exp" : 1883000000\n             },\n             "issuingDID": "did:prism:9f847f8bbb66c112f71d08ab39930d468ccbfe1e0e1d002be53d46c431212c26",\n             "credentialSchema": {\n                "id: "http://localhost:8080/cloud-agent/schema-registry/schemas/3f86a73f-5b78-39c7-af77-0c16123fa9c2",\n                "type": "JsonSchemaValidator2018"\n             }\n          }\n        }\'\n'})})})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"sending-the-offer-to-the-holder",children:"Sending the Offer to the Holder"}),"\n",(0,r.jsxs)(n.p,{children:["The next step for the Issuer is to send the offer to the holder using DIDComm.\nTo do this, the Issuer agent will process the offer and send it to the holder agent.\nThis process is automatic. The state of the Issuer's record will change to ",(0,r.jsx)(n.code,{children:"OfferSent"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"issuing-the-credential",children:"Issuing the Credential"}),"\n",(0,r.jsxs)(n.p,{children:["Once the holder has approved the offer and sent a request to the Issuer,\nthe Issuer will receive the request via DIDComm and update the record state to ",(0,r.jsx)(n.code,{children:"RequestReceived."})]}),"\n",(0,r.jsxs)(n.p,{children:["The Issuer can then use\nthe ",(0,r.jsx)(n.a,{href:"/documentation/reference/Cloud%20Agent%20API/identus-cloud-agent-api-reference/#tag/Issue-Credentials-Protocol/operation/issueCredential",children:(0,r.jsx)(n.code,{children:"/issue-credentials/records/{recordId}/issue-credential"})}),"\nendpoint to issue the credential to the holder."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'# Issuer POST request to issue the credential\n# make sure you have `issuer_record_id` extracted from created credential offer\n# and the record achieved `RequestReceived` state\ncurl -X POST \\\n    "http://localhost:8080/cloud-agent/issue-credentials/records/$issuer_record_id/issue-credential" \\\n    -H "Content-Type: application/json" \\\n    -H "apikey: $API_KEY"\n'})}),"\n",(0,r.jsxs)(n.p,{children:["When this endpoint gets called, the state of the record will change to ",(0,r.jsx)(n.code,{children:"CredentialPending,"})," and after processing, it\nwill change to ",(0,r.jsx)(n.code,{children:"CredentialGenerated."})]}),"\n",(0,r.jsxs)(n.p,{children:["Finally, the Issuer agent will send the credential to the holder via DIDComm,\nand the state of the record will change to ",(0,r.jsx)(n.code,{children:"CredentialSent"}),".\nAt this point, the Issuer's interactions with the holder are complete."]}),"\n",(0,r.jsx)(n.mermaid,{value:"---\ntitle: Issuer flow\n---\nstateDiagram-v2\n  [*] --\x3e OfferPending: create credential offer (`/issue-credentials/credential-offers`)\n  OfferPending --\x3e OfferSent: send offer (auto via Cloud Agent DIDComm)\n  OfferSent --\x3e RequestReceived: receive request (auto via Cloud Agent DIDComm)\n  RequestReceived --\x3e CredentialPending: issue credential (`/issue-credentials/records/{recordId}/issue-credential`)\n  CredentialPending --\x3e CredentialGenerated: process issued credential (auto via Cloud Agent)\n  CredentialGenerated --\x3e CredentialSent: send credential (auto via Cloud Agent)"}),"\n",(0,r.jsx)(n.h2,{id:"holder-interactions",children:"Holder interactions"}),"\n",(0,r.jsx)(n.p,{children:"This section describes the Holder role's available interactions with the Cloud Agent."}),"\n",(0,r.jsx)(n.h3,{id:"receiving-the-vc-offer",children:"Receiving the VC Offer"}),"\n",(0,r.jsxs)(n.p,{children:["The Holder will receive the offer from the Issuer via DIDComm,\nand a new credential record with a unique ID gets created in the ",(0,r.jsx)(n.code,{children:"OfferReceived"})," state."]}),"\n",(0,r.jsx)(n.p,{children:"This process is automatic for the Cloud Agent."}),"\n",(0,r.jsxs)(n.p,{children:["You could check if a new credential offer is available\nusing ",(0,r.jsx)(n.a,{href:"/#tag/Issue-Credentials-Protocol/operation/getCredentialRecords",children:(0,r.jsx)(n.code,{children:"/issue-credentials/records"})})," request and check\nfor any records available in ",(0,r.jsx)(n.code,{children:"OfferReceived"})," state:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'# Holder GET request to retrieve credential records\ncurl "http://localhost:8090/cloud-agent/issue-credentials/records" \\\n    -H "Content-Type: application/json" \\\n    -H "apikey: $API_KEY"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"approving-the-vc-offer",children:"Approving the VC Offer"}),"\n",(0,r.jsxs)(n.p,{children:["To accept the offer, the Holder can make a ",(0,r.jsx)(n.code,{children:"POST"})," request to\nthe ",(0,r.jsx)(n.a,{href:"/documentation/reference/Cloud%20Agent%20API/identus-cloud-agent-api-reference/#tag/Issue-Credentials-Protocol/operation/acceptCredentialOffer",children:(0,r.jsx)(n.code,{children:"/issue-credentials/records/{recordId}/accept-offer"})}),"\nendpoint with a JSON payload that includes the following information:"]}),"\n",(0,r.jsxs)(d.A,{groupId:"vc-formats",children:[(0,r.jsxs)(a.default,{value:"jwt",label:"JWT",children:[(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"holder_record_id"}),": The unique identifier of the issue credential record known by the holder's Cloud Agent."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"subjectId"}),": This field represents the unique identifier for the subject of the verifiable credential. It is a\nshort-form PRISM ",(0,r.jsx)(n.a,{href:"/documentation/learn/glossary#decentralized-identifier",children:"DID"})," string, such\nas ",(0,r.jsx)(n.code,{children:"did:prism:subjectIdentifier"}),"."]}),"\n"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'# Holder POST request to accept the credential offer\ncurl -X POST "http://localhost:8090/cloud-agent/issue-credentials/records/$holder_record_id/accept-offer" \\\n    -H \'accept: application/json\' \\\n    -H \'Content-Type: application/json\' \\\n    -H "apikey: $API_KEY" \\\n    -d \'{\n          "subjectId": "did:prism:subjectIdentifier"\n     }\'\n'})})]}),(0,r.jsxs)(a.default,{value:"anoncreds",labal:"AnonCreds",children:[(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"holder_record_id"}),": The unique identifier of the issue credential record known by the holder's Cloud Agent."]}),"\n"]}),(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"# Holder POST request to accept the credential offer\ncurl -X POST \"http://localhost:8090/cloud-agent/issue-credentials/records/$holder_record_id/accept-offer\" \\\n    -H 'accept: application/json' \\\n    -H 'Content-Type: application/json' \\\n    -H \"apikey: $API_KEY\" \\\n    -d '{}'\n"})})]}),(0,r.jsx)(a.default,{value:"sdjwt",label:"SDJWT",children:(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"holder_record_id"}),": The unique identifier of the issue credential record known by the holder's Cloud Agent."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"subjectId"}),": This field represents the unique identifier for the subject of the verifiable credential. It is a\nshort-form PRISM ",(0,r.jsx)(n.a,{href:"/documentation/learn/glossary#decentralized-identifier",children:"DID"})," string, such\nas ",(0,r.jsx)(n.code,{children:"did:prism:subjectIdentifier"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"keyId"})," Option parameter"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"when keyId is not provided the SDJWT VC is not binded to Holder/Prover key"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'# Holder POST request to accept the credential offer\ncurl -X POST "http://localhost:8090/cloud-agent/issue-credentials/records/$holder_record_id/accept-offer" \\\n    -H \'accept: application/json\' \\\n    -H \'Content-Type: application/json\' \\\n    -H "apikey: $API_KEY" \\\n    -d \'{\n          "subjectId": "did:prism:subjectIdentifier"\n     }\'\n'})}),"\n",(0,r.jsxs)(n.p,{children:["A SD-JWT Verifiable Credential (VC) without a ",(0,r.jsx)(n.code,{children:"cnf"})," key could possibly look like below"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:' {\n  "_sd": [\n    "CrQe7S5kqBAHt-nMYXgc6bdt2SH5aTY1sU_M-PgkjPI",\n    "JzYjH4svliH0R3PyEMfeZu6Jt69u5qehZo7F7EPYlSE",\n    "PorFbpKuVu6xymJagvkFsFXAbRoc2JGlAUA2BA4o7cI",\n    "TGf4oLbgwd5JQaHyKVQZU9UdGE0w5rtDsrZzfUaomLo",\n    "XQ_3kPKt1XyX7KANkqVR6yZ2Va5NrPIvPYbyMvRKBMM",\n    "XzFrzwscM6Gn6CJDc6vVK8BkMnfG8vOSKfpPIZdAfdE",\n    "gbOsI4Edq2x2Kw-w5wPEzakob9hV1cRD0ATN3oQL9JM",\n    "jsu9yVulwQQlhFlM_3JlzMaSFzglhQG0DpfayQwLUK4"\n  ],\n  "iss": "https://issuer.example.com",\n  "iat": 1683000000,\n  "exp": 1883000000,\n  "sub": "user_42",\n  "_sd_alg": "sha-256"\n}\n'})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"keyId"}),": This is optional field but must be specified to choose which key bounds to the verifiable credential.\nFor more information on\nkey-binding, ",(0,r.jsx)(n.a,{href:"https://datatracker.ietf.org/doc/draft-ietf-oauth-selective-disclosure-jwt",children:"ietf-oauth-selective-disclosure-jwt"}),".\nCurrently, we only support the EdDSA algorithm and curve Ed25519.\nThe specified keyId should be of type Ed25519.\nThe purpose of the keyId should be authentication."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'# Holder POST request to accept the credential offer with keyId\ncurl -X POST "http://localhost:8090/cloud-agent/issue-credentials/records/$holder_record_id/accept-offer" \\\n    -H \'accept: application/json\' \\\n    -H \'Content-Type: application/json\' \\\n    -H "apikey: $API_KEY" \\\n    -d \'{\n          "subjectId": "did:prism:subjectIdentifier",\n          "keyId": "key-1"    \n     }\'\n'})}),"\n",(0,r.jsxs)(n.p,{children:["A SD-JWT Verifiable Credential (VC) that includes a ",(0,r.jsx)(n.code,{children:"cnf"})," key could possibly look like below"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:' {\n  "_sd": [\n    "CrQe7S5kqBAHt-nMYXgc6bdt2SH5aTY1sU_M-PgkjPI",\n    "JzYjH4svliH0R3PyEMfeZu6Jt69u5qehZo7F7EPYlSE",\n    "PorFbpKuVu6xymJagvkFsFXAbRoc2JGlAUA2BA4o7cI",\n    "TGf4oLbgwd5JQaHyKVQZU9UdGE0w5rtDsrZzfUaomLo",\n    "XQ_3kPKt1XyX7KANkqVR6yZ2Va5NrPIvPYbyMvRKBMM",\n    "XzFrzwscM6Gn6CJDc6vVK8BkMnfG8vOSKfpPIZdAfdE",\n    "gbOsI4Edq2x2Kw-w5wPEzakob9hV1cRD0ATN3oQL9JM",\n    "jsu9yVulwQQlhFlM_3JlzMaSFzglhQG0DpfayQwLUK4"\n  ],\n  "iss": "https://issuer.example.com",\n  "iat": 1683000000,\n  "exp": 1883000000,\n  "sub": "user_42",\n  "_sd_alg": "sha-256",\n  "cnf": {\n    "jwk": {\n      "kty": "EC",\n      "crv": "P-256",\n      "x": "TCAER19Zvu3OHF4j4W4vfSVoHIP1ILilDls7vCeGemc",\n      "y": "ZxjiWWbZMQGHVWKVQ4hbSIirsVfuecCE6t4jT9F2HZQ"\n    }\n  }\n}\n'})}),"\n"]}),"\n"]})})]}),"\n",(0,r.jsxs)(n.p,{children:["This request will change the state of the record to ",(0,r.jsx)(n.code,{children:"RequestPending"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"receiving-the-vc-credential",children:"Receiving the VC Credential"}),"\n",(0,r.jsxs)(n.p,{children:["Once the Holder has approved the offer and sent a request to the Issuer, the Holder agent will process the request and\nsend it to the Issuer agent.\nThe state of the Holder's record will change to ",(0,r.jsx)(n.code,{children:"RequestSent"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["After the Issuer has issued the credential, the Holder will receive the credential via DIDComm, and the state of the\nHolder's record will change to ",(0,r.jsx)(n.code,{children:"CredentialReceived"}),".\nThis process is automatic for the Cloud Agent."]}),"\n",(0,r.jsxs)(n.p,{children:["The Holder can check the achieved credential using a GET request\nto ",(0,r.jsx)(n.a,{href:"/documentation/reference/Cloud%20Agent%20API/identus-cloud-agent-api-reference/#tag/Issue-Credentials-Protocol/operation/getCredentialRecord",children:(0,r.jsx)(n.code,{children:"/issue-credentials/records/{recordId}/"})}),"\nendpoint."]}),"\n",(0,r.jsx)(n.mermaid,{value:"---\ntitle: Holder Flow\n---\nstateDiagram-v2\n  [*] --\x3e OfferReceived: receive offer (auto via Cloud Agent)\n  OfferReceived --\x3e RequestPending: accept offer (`/issue-credentials/records/{recordId}/accept-offer`)\n  RequestPending --\x3e RequestSent: send request (auto via Cloud Agent)\n  RequestSent --\x3e CredentialReceived: receive credential (auto via Cloud Agent)"}),"\n",(0,r.jsx)(n.h2,{id:"sequence-diagram",children:"Sequence diagram"}),"\n",(0,r.jsx)(n.p,{children:"The following diagram shows the end-to-end flow for an issuer to issue a VC to a holder."}),"\n",(0,r.jsxs)(d.A,{groupId:"vc-formats",children:[(0,r.jsx)(a.default,{value:"jwt",label:"JWT",children:(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:s(10121).A+"",width:"1362",height:"2017"})})}),(0,r.jsx)(a.default,{value:"anoncreds",label:"AnonCreds",children:(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:s(91387).A+"",width:"1625",height:"2188"})})})]})]})}function f(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},91387:(e,n,s)=>{s.d(n,{A:()=>i});const i=s.p+"assets/images/issue-flow.anoncreds-0756e11aed09e7507347ce0ebdbf378e.png"}}]);