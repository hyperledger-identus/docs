"use strict";(self.webpackChunkidentus_documentation_portal=self.webpackChunkidentus_documentation_portal||[]).push([[4649],{36936:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>i,default:()=>h,frontMatter:()=>s,metadata:()=>d,toc:()=>l});var a=t(74848),r=t(28453);const s={},i="Managing VDR entries",d={id:"vdr/manage",title:"Managing VDR entries",description:"The VDR specification defines a mechanism for creating,",source:"@site/cloud-agent/docs/docusaurus/vdr/manage.md",sourceDirName:"vdr",slug:"/vdr/manage",permalink:"/docs/tutorials/vdr/manage",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialsSidebar",previous:{title:"Admin Authorization with External IAM",permalink:"/docs/tutorials/multitenancy/admin-authz-ext-iam"}},o={},l=[{value:"Roles",id:"roles",level:2},{value:"Endpoints",id:"endpoints",level:2},{value:"1. Create a sample binary data to store",id:"1-create-a-sample-binary-data-to-store",level:3},{value:"2. Create a new VDR entry with sample data",id:"2-create-a-new-vdr-entry-with-sample-data",level:3},{value:"3. Resolve the data using VDR URL",id:"3-resolve-the-data-using-vdr-url",level:3},{value:"4. Compare the VDR entry and the input",id:"4-compare-the-vdr-entry-and-the-input",level:3},{value:"5. Deactivate the VDR entry",id:"5-deactivate-the-vdr-entry",level:3}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.h1,{id:"managing-vdr-entries",children:"Managing VDR entries"}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.a,{href:"https://github.com/hyperledger-identus/vdr",children:"VDR specification"})," defines a mechanism for creating,\nupdating, deactivating, and retrieving data from various data sources.\nThese sources are abstracted, enabling a unified integration interface for other systems.\nA reference implementation of the VDR is available as a library ",(0,a.jsx)(n.a,{href:"https://github.com/hyperledger-identus/vdr",children:"here"}),",\nand an HTTP binding is also provided within the Cloud Agent."]}),"\n",(0,a.jsx)(n.p,{children:"The purpose of the VDR is to store data used across various SSI protocols.\nIn many use cases, these protocols need to reference external resources using URIs.\nFor example: credential status lists.\nSince the interface is storage-agnostic, switching the underlying storage implementation is trivial."}),"\n",(0,a.jsx)(n.p,{children:"VDR is capable of storing arbitrary bytes.\nIn this tutorial, we will create a sample binary data and resolve the VDR to compare those bytes.\nThen we will try to deactivate the data and observe the resolution failure."}),"\n",(0,a.jsx)(n.h2,{id:"roles",children:"Roles"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["The ",(0,a.jsx)(n.strong,{children:"data owner"})," - is responsible for managing the VDR entries and their lifecycle."]}),"\n"]}),"\n",(0,a.jsx)(n.h1,{id:"overview",children:"Overview"}),"\n",(0,a.jsx)(n.p,{children:"In this example, we will store data using a database driver to enable easy setup and testing."}),"\n",(0,a.jsx)(n.h2,{id:"endpoints",children:"Endpoints"}),"\n",(0,a.jsx)(n.p,{children:"The example uses the following endpoints"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Endpoint"}),(0,a.jsx)(n.th,{children:"Description"}),(0,a.jsx)(n.th,{children:"Role"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"GET /vdr/entires"})}),(0,a.jsx)(n.td,{children:"Resolve the data using VDR URI"}),(0,a.jsx)(n.td,{children:"Anyone"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"POST /vdr/entries"})}),(0,a.jsx)(n.td,{children:"Create a new VDR entry"}),(0,a.jsx)(n.td,{children:"Data owner"})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"DELETE /vdr/entries"})}),(0,a.jsx)(n.td,{children:"Delete the VDR entry"}),(0,a.jsx)(n.td,{children:"Data owner"})]})]})]}),"\n",(0,a.jsx)(n.h3,{id:"1-create-a-sample-binary-data-to-store",children:"1. Create a sample binary data to store"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"echo -ne '\\x01\\x02\\x03\\x04' > sample_in.bin\n"})}),"\n",(0,a.jsxs)(n.p,{children:["We should have a file named ",(0,a.jsx)(n.code,{children:"sample_in.bin"})," containing 4 bytes"]}),"\n",(0,a.jsx)(n.h3,{id:"2-create-a-new-vdr-entry-with-sample-data",children:"2. Create a new VDR entry with sample data"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -X POST "http://localhost:8080/cloud-agent/vdr/entries?drid=database" \\\n  -H "Content-Type: application/octet-stream" \\\n  --data-binary @sample_in.bin\n'})}),"\n",(0,a.jsx)(n.p,{children:"The response should look something like"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "url":"vdr://?drf=memory&drid=memory&drv=0.1.0&m=0#d63bdd21-0347-4caf-a255-0cca7c2851fe"\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"The URL is the locator for the VDR entry.\nIf referenced in the SSI protocol, anyone should be able to resolve this data.\nIn this example, we are using only a database driver, so the data is resolvable only within the same agent instance."}),"\n",(0,a.jsx)(n.h3,{id:"3-resolve-the-data-using-vdr-url",children:"3. Resolve the data using VDR URL"}),"\n",(0,a.jsx)(n.p,{children:"Take the URL from previous step and run this command to resolve the URL."}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -X GET "http://localhost:8080/cloud-agent/vdr/entries?url=<ENCODED_VDR_URL>" > sample_out.bin\n'})}),"\n",(0,a.jsxs)(n.p,{children:["Remember to encode the URL using percent encoding to escape any reserved characters in the URL syntax.\nIf executed successfully, the response status should be 200, with the response body saved to a file named ",(0,a.jsx)(n.code,{children:"sample_out.bin"}),"."]}),"\n",(0,a.jsx)(n.h3,{id:"4-compare-the-vdr-entry-and-the-input",children:"4. Compare the VDR entry and the input"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"diff sample_in.bin sample_out.bin\n"})}),"\n",(0,a.jsxs)(n.p,{children:["The output of the ",(0,a.jsx)(n.code,{children:"diff"})," command should be empty, as the VDR entry is exactly the same as the input data."]}),"\n",(0,a.jsx)(n.h3,{id:"5-deactivate-the-vdr-entry",children:"5. Deactivate the VDR entry"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:'curl -X DELETE "http://localhost:8080/cloud-agent/vdr/entries?url=<ENCODED_VDR_URL>"\n'})}),"\n",(0,a.jsxs)(n.p,{children:["Similar to resolving the data, we now change the HTTP method to ",(0,a.jsx)(n.code,{children:"DELETE"})," to deactivate the VDR entry.\nThe response status should be 200, indicating a successful operation."]}),"\n",(0,a.jsx)(n.p,{children:"After trying to resolve the VDR entry in step 3, the response should be"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "status":404,\n  "type":"error:VdrServiceError:VdrEntryNotFound",\n  "title":"Vdr Entry Not Found",\n  "detail":"The data could not be found from a provided URL",\n  "instance":"error:instance:b70984a1-71f5-409f-9afc-3b8bada54445"\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"indicating the resource is no longer available for resolution."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>d});var a=t(96540);const r={},s=a.createContext(r);function i(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),a.createElement(s.Provider,{value:n},e.children)}}}]);