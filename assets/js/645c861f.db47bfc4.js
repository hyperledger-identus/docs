"use strict";(self.webpackChunkidentus_documentation_portal=self.webpackChunkidentus_documentation_portal||[]).push([[830],{74981:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>r,contentTitle:()=>o,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>c});var i=n(74848),a=n(28453);const d={},o="Deactivate DID",s={id:"dids/deactivate",title:"Deactivate DID",description:"DID deactivation is an important feature that provides greater control for managing digital identity.",source:"@site/cloud-agent/docs/docusaurus/dids/deactivate.md",sourceDirName:"dids",slug:"/dids/deactivate",permalink:"/docs/tutorials/dids/deactivate",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"tutorialsSidebar",previous:{title:"Publish DID",permalink:"/docs/tutorials/dids/publish"},next:{title:"Schemas",permalink:"/docs/tutorials/category/schemas"}},r={},c=[{value:"Roles",id:"roles",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Overview",id:"overview",level:2},{value:"Endpoints",id:"endpoints",level:2},{value:"DID Controller interactions",id:"did-controller-interactions",level:2},{value:"1. Check the current state of the DID document",id:"1-check-the-current-state-of-the-did-document",level:3},{value:"2. Requesting the DID deactivation to PRSIM Agent",id:"2-requesting-the-did-deactivation-to-prsim-agent",level:3},{value:"3. Wait for the confirmation and observe the change in the DID metadata",id:"3-wait-for-the-confirmation-and-observe-the-change-in-the-did-metadata",level:3}];function l(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h1,{id:"deactivate-did",children:"Deactivate DID"}),"\n",(0,i.jsxs)(t.p,{children:["DID deactivation is an important feature that provides greater control for managing digital identity.\nDID deactivation can be helpful if the ",(0,i.jsx)(t.a,{href:"/docs/concepts/glossary#decentralized-identifier",children:"DID"})," is compromised or unused.\nThis feature is crucial for the security and risk management of identity owners."]}),"\n",(0,i.jsxs)(t.p,{children:["Similar to ",(0,i.jsx)(t.a,{href:"/docs/tutorials/dids/update",children:"DID update"}),", deactivating a PRISM DID is a process of putting deactivate-operation on the blockchain so that other participants know that the DID is no longer active.\nThe PRISM DID method only allows published DID to be deactivated."]}),"\n",(0,i.jsx)(t.h2,{id:"roles",children:"Roles"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:"DID Controller is the organization or individual who has control of the DID."}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:"DID Controller Cloud Agent up and running"}),"\n",(0,i.jsxs)(t.li,{children:["DID Controller has a DID created on the Cloud Agent (see ",(0,i.jsx)(t.a,{href:"/docs/tutorials/dids/create",children:"Create DID"}),")"]}),"\n",(0,i.jsxs)(t.li,{children:["DID Controller has a DID published to the blockchain (see ",(0,i.jsx)(t.a,{href:"/docs/tutorials/dids/publish",children:"Publish DID"}),")"]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsxs)(t.p,{children:["DID deactivation operates similarly to the DID update, where deactivate-operation publishes to the blockchain, and confirmation blocks must be created before participants consider it deactivated.\nOnce the DID is deactivated, all content in the ",(0,i.jsx)(t.a,{href:"/docs/concepts/glossary#did-document",children:"DID document"})," gets deleted, and no operation will affect the DID afterward.\nThe same concept also holds for PRISM DID deactivation in that the fork can occur if any subsequent operation occurs before the operation is confirmed.\nPlease refer to the ",(0,i.jsx)(t.code,{children:"SECURE_DEPTH"})," parameter in ",(0,i.jsx)(t.a,{href:"https://github.com/input-output-hk/prism-did-method-spec/blob/main/w3c-spec/PRISM-method.md#versioning-and-protocol-parameters",children:"PRISM method - protocol parameters"})," for the number of confirmation blocks.\nAt the time of writing, this number is 112 blocks."]}),"\n",(0,i.jsxs)(t.p,{children:["DID deactivation is easily performed with the Cloud Agent.\nUnder the hood, the Cloud Agent uses the ",(0,i.jsx)(t.code,{children:"MASTER"})," keys to sign the intended operation and automatically post the operation to the blockchain.\nThis example shows the DID deactivation and steps to observe the changes to the DID using the Cloud Agent."]}),"\n",(0,i.jsx)(t.h2,{id:"endpoints",children:"Endpoints"}),"\n",(0,i.jsx)(t.p,{children:"The example uses the following endpoints"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Endpoint"}),(0,i.jsx)(t.th,{children:"Description"}),(0,i.jsx)(t.th,{children:"Role"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.a,{href:"/agent-api/#tag/DID-Registrar/operation/deactivateManagedDid",children:(0,i.jsx)(t.code,{children:"POST /did-registrar/dids/{didRef}/deactivations"})})}),(0,i.jsx)(t.td,{children:"Deactivate a PRISM DID"}),(0,i.jsx)(t.td,{children:"DID Controller"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.a,{href:"/agent-api/#tag/DID/operation/getDid",children:(0,i.jsx)(t.code,{children:"GET /dids/{didRef}"})})}),(0,i.jsx)(t.td,{children:"Resolve a DID to DID document representation"}),(0,i.jsx)(t.td,{children:"DID Controller"})]})]})]}),"\n",(0,i.jsx)(t.h2,{id:"did-controller-interactions",children:"DID Controller interactions"}),"\n",(0,i.jsx)(t.h3,{id:"1-check-the-current-state-of-the-did-document",children:"1. Check the current state of the DID document"}),"\n",(0,i.jsx)(t.p,{children:"Given the DID Controller has a DID managed by the Cloud Agent and that DID is published, he can resolve the DID document using short-form DID."}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"curl --location --request GET 'http://localhost:8080/cloud-agent/dids/{didRef}' \\\n--header \"apikey: $API_KEY\" \\\n--header 'Accept: */*'\n"})}),"\n",(0,i.jsx)(t.p,{children:"Example DID document response (some fields omitted for readability)"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-json",children:'{\n    "didDocument": {...},\n    "didDocumentMetadata": {\n        "canonicalId": "did:prism:66e431434f201c7ae43f6e63569f1ee556d7dfbee1646101547324013e545d2c",\n        "deactivated": false,\n        ...\n    },\n    "didResolutionMetadata": {...}\n}\n'})}),"\n",(0,i.jsxs)(t.p,{children:["The DID metadata shows the ",(0,i.jsx)(t.code,{children:"deactivation"})," status as ",(0,i.jsx)(t.code,{children:"false"}),", meaning that this DID is still active."]}),"\n",(0,i.jsx)(t.h3,{id:"2-requesting-the-did-deactivation-to-prsim-agent",children:"2. Requesting the DID deactivation to PRSIM Agent"}),"\n",(0,i.jsxs)(t.p,{children:["The active status comes from the last step.\nThe DID deactivation can be performed by calling ",(0,i.jsx)(t.code,{children:"POST /did-registrar/dids/{didRef}/deactivations"})," and replacing ",(0,i.jsx)(t.code,{children:"{didRef}"})," with the DID to deactivate."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:"curl --location --request POST 'http://localhost:8080/cloud-agent/did-registrar/dids/{didRef}/deactivations' \\\n--header \"apikey: $API_KEY\" \\\n--header 'Accept: application/json'\n"})}),"\n",(0,i.jsx)(t.p,{children:"Under the hood, the Cloud Agent constructs the DID deactivate-operation from the last confirmed operation observed on the blockchain.\nThe DID Controller should receive a response about the scheduled operation, waiting for confirmation on the blockchain.\nIf this deactivate-operation gets confirmed on the blockchain and not discarded as a fork, the DID becomes deactivated."}),"\n",(0,i.jsx)(t.h3,{id:"3-wait-for-the-confirmation-and-observe-the-change-in-the-did-metadata",children:"3. Wait for the confirmation and observe the change in the DID metadata"}),"\n",(0,i.jsx)(t.p,{children:"When the DID Controller tries to resolve the DID again using the example in Step 1,\nthe content might remain the same because the operation still needs to be confirmed and applied."}),"\n",(0,i.jsxs)(t.p,{children:["The DID Controller keeps polling this endpoint until the ",(0,i.jsx)(t.code,{children:"deactivated"})," status in DID document metadata changes to ",(0,i.jsx)(t.code,{children:"true"}),"."]}),"\n",(0,i.jsx)(t.p,{children:"Example response of deactivated DID document (some fields omitted for readability)"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-json",children:'{\n    "didDocumentMetadata": {\n        "canonicalId": "did:prism:66e431434f201c7ae43f6e63569f1ee556d7dfbee1646101547324013e545d2c",\n        "deactivated": true,\n        ...\n    },\n    "didResolutionMetadata": {...}\n}\n'})}),"\n",(0,i.jsxs)(t.p,{children:["The DID metadata indicates that the DID is deactivated and the ",(0,i.jsx)(t.code,{children:"didDocument"})," is empty."]})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>s});var i=n(96540);const a={},d=i.createContext(a);function o(e){const t=i.useContext(d);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),i.createElement(d.Provider,{value:t},e.children)}}}]);