<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-docs docs-version-current docs-doc-page docs-doc-id-cloud-agent/docs/docusaurus/multitenancy/tenant-onboarding-self-service" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Tenant Onboarding Self-Service | Hyperledger Identus</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://hyperledger-identus.github.io/docs/cloud-agent/docs/docusaurus/multitenancy/tenant-onboarding-self-service"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-docs-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-docs-current"><meta data-rh="true" property="og:title" content="Tenant Onboarding Self-Service | Hyperledger Identus"><meta data-rh="true" name="description" content="In the Tenant Onboarding with External IAM tutorial,"><meta data-rh="true" property="og:description" content="In the Tenant Onboarding with External IAM tutorial,"><link data-rh="true" rel="icon" href="/docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://hyperledger-identus.github.io/docs/cloud-agent/docs/docusaurus/multitenancy/tenant-onboarding-self-service"><link data-rh="true" rel="alternate" href="https://hyperledger-identus.github.io/docs/cloud-agent/docs/docusaurus/multitenancy/tenant-onboarding-self-service" hreflang="en"><link data-rh="true" rel="alternate" href="https://hyperledger-identus.github.io/docs/cloud-agent/docs/docusaurus/multitenancy/tenant-onboarding-self-service" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Cloud Agent","item":"https://hyperledger-identus.github.io/docs/category/cloud-agent"},{"@type":"ListItem","position":2,"name":"Tutorials","item":"https://hyperledger-identus.github.io/docs/cloud-agent/docs/docusaurus/"},{"@type":"ListItem","position":3,"name":"Tenant Onboarding Self-Service","item":"https://hyperledger-identus.github.io/docs/cloud-agent/docs/docusaurus/multitenancy/tenant-onboarding-self-service"}]}</script><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-BLNS09BXBY"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-BLNS09BXBY",{anonymize_ip:!0})</script><link rel="stylesheet" href="/docs/assets/css/styles.e9647785.css">
<script src="/docs/assets/js/runtime~main.e5ae3038.js" defer="defer"></script>
<script src="/docs/assets/js/main.cf24eb1c.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/identus-navbar-light.png" alt="Identus logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/docs/img/identus-navbar-light.png" alt="Identus logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/docs/documentation/learn/">Learn</a><a class="navbar__item navbar__link" href="/docs/documentation/developers/">Developers</a><a class="navbar__item navbar__link" href="/docs/documentation/reference/">Reference</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item hidden-sidebar-item"><a class="menu__link" href="/docs/documentation/developers/"><span title="Developers" class="linkLabel_WmDU">Developers</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/docs/category/sdks"><span title="SDKs" class="categoryLinkLabel_W154">SDKs</span></a><button aria-label="Expand sidebar category &#x27;SDKs&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/docs/category/cloud-agent"><span title="Cloud Agent" class="categoryLinkLabel_W154">Cloud Agent</span></a><button aria-label="Collapse sidebar category &#x27;Cloud Agent&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/cloud-agent/docs/docusaurus/"><span title="Tutorials" class="categoryLinkLabel_W154">Tutorials</span></a><button aria-label="Collapse sidebar category &#x27;Tutorials&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/documentation/developers/quick-start"><span title="Quick Start Guide" class="linkLabel_WmDU">Quick Start Guide</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cloud-agent/docs/docusaurus/connections/connection"><span title="Connections" class="linkLabel_WmDU">Connections</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/category/credentials"><span title="Credentials" class="categoryLinkLabel_W154">Credentials</span></a><button aria-label="Expand sidebar category &#x27;Credentials&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/category/dids"><span title="DIDs" class="categoryLinkLabel_W154">DIDs</span></a><button aria-label="Expand sidebar category &#x27;DIDs&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/category/schemas"><span title="Schemas" class="categoryLinkLabel_W154">Schemas</span></a><button aria-label="Expand sidebar category &#x27;Schemas&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/category/credential-definition"><span title="Credential Definition" class="categoryLinkLabel_W154">Credential Definition</span></a><button aria-label="Expand sidebar category &#x27;Credential Definition&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/docs/category/secret-management"><span title="Secret Management" class="categoryLinkLabel_W154">Secret Management</span></a><button aria-label="Expand sidebar category &#x27;Secret Management&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/cloud-agent/docs/docusaurus/webhooks/webhook"><span title="Webhooks" class="categoryLinkLabel_W154">Webhooks</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/cloud-agent/docs/docusaurus/multitenancy/tenant-onboarding"><span title="Multi-Tenancy" class="categoryLinkLabel_W154">Multi-Tenancy</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cloud-agent/docs/docusaurus/multitenancy/tenant-onboarding"><span title="Tenant Onboarding" class="linkLabel_WmDU">Tenant Onboarding</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cloud-agent/docs/docusaurus/multitenancy/tenant-onboarding-ext-iam"><span title="Tenant Onboarding with External IAM" class="linkLabel_WmDU">Tenant Onboarding with External IAM</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/cloud-agent/docs/docusaurus/multitenancy/tenant-onboarding-self-service"><span title="Tenant Onboarding Self-Service" class="linkLabel_WmDU">Tenant Onboarding Self-Service</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cloud-agent/docs/docusaurus/multitenancy/tenant-migration"><span title="Migration from apikey to JWT authentication" class="linkLabel_WmDU">Migration from apikey to JWT authentication</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/cloud-agent/docs/docusaurus/multitenancy/admin-authz-ext-iam"><span title="Admin Authorization with External IAM" class="linkLabel_WmDU">Admin Authorization with External IAM</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/cloud-agent/docs/docusaurus/vdr/manage"><span title="VDR" class="categoryLinkLabel_W154">VDR</span></a></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/documentation/developers/cloud-agent/building-blocks"><span title="Building Blocks" class="linkLabel_WmDU">Building Blocks</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/documentation/developers/cloud-agent/environment-variables"><span title="Environment variables" class="linkLabel_WmDU">Environment variables</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/documentation/developers/cloud-agent/authentication"><span title="Authentication and Authorisation" class="linkLabel_WmDU">Authentication and Authorisation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/documentation/developers/cloud-agent/did-management"><span title="DID management" class="linkLabel_WmDU">DID management</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/documentation/developers/cloud-agent/node-backend"><span title="Node Backend" class="linkLabel_WmDU">Node Backend</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/documentation/developers/cloud-agent/secrets-storage"><span title="Secrets Storage" class="linkLabel_WmDU">Secrets Storage</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/documentation/developers/cloud-agent/troubleshooting&amp;considerations"><span title="Troubleshooting &amp; Considerations" class="linkLabel_WmDU">Troubleshooting &amp; Considerations</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/documentation/developers/cloud-agent/vdr"><span title="VDR Interface" class="linkLabel_WmDU">VDR Interface</span></a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/category/cloud-agent"><span>Cloud Agent</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/cloud-agent/docs/docusaurus/"><span>Tutorials</span></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Multi-Tenancy</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Tenant Onboarding Self-Service</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Tenant Onboarding Self-Service</h1></header>
<p>In the <a class="" href="/docs/cloud-agent/docs/docusaurus/multitenancy/tenant-onboarding-ext-iam">Tenant Onboarding with External IAM</a> tutorial,
we learned how <a class="" href="/docs/documentation/learn/glossary#keycloak-service">Keycloak</a> helps with user access and how it works together with the agent.
To set things up, the admin has to provision the required resources.
However, relying on the admin for onboarding operations can be restrictive for some use cases.
For example, some tenants might want to onboard on a self-service agent instance without admin intervention.</p>
<p>By leveraging Keycloak for a self-service agent instance,
users can self-register or link to other <a class="" href="/docs/documentation/learn/glossary#idp">Identity Providers (IDPs)</a> to register an account.
Once the account is registered, users can use it to set up their wallets.
This tutorial will investigate the steps to facilitate this scenario where <a class="" href="/docs/documentation/learn/glossary#administrator">administrator</a> intervention is unnecessary.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="roles">Roles<a href="#roles" class="hash-link" aria-label="Direct link to Roles" title="Direct link to Roles" translate="no">​</a></h2>
<p>In self-service tenant management with external IAM, there is only one role:</p>
<ol>
<li class=""><a class="" href="/docs/documentation/learn/glossary#tenant">Tenant</a></li>
</ol>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites" translate="no">​</a></h2>
<ol>
<li class="">Keycloak is up and running.</li>
<li class="">Keycloak is configured as follows<!-- -->
<ol>
<li class="">A realm called <code>my-realm</code> is created</li>
<li class="">A client called <code>cloud-agent</code> under <code>my-realm</code> with <strong>authorization</strong> feature is created. (See <a href="https://www.keycloak.org/docs/latest/authorization_services/index.html#_resource_server_create_client" target="_blank" rel="noopener noreferrer" class="">create client instruction</a>)</li>
<li class="">Make sure the <code>cloud-agent</code> client has <strong>direct access grants</strong> enabled to simplify the login process for this tutorial.</li>
<li class="">Make sure to <a href="https://www.keycloak.org/docs/latest/server_admin/index.html#con-user-registration_server_administration_guide" target="_blank" rel="noopener noreferrer" class="">allow user self-registration</a>.</li>
</ol>
</li>
<li class="">The Cloud Agent is up and running</li>
<li class="">The Cloud Agent is configured with the following environment variables:<!-- -->
<ol>
<li class=""><code>ADMIN_TOKEN=my-admin-token</code></li>
<li class=""><code>DEFAULT_WALLET_ENABLED=false</code></li>
<li class=""><code>KEYCLOAK_ENABLED=true</code></li>
<li class=""><code>KEYCLOAK_URL=http://localhost:9980</code> (replace with appropriate value)</li>
<li class=""><code>KEYCLOAK_REALM=my-realm</code></li>
<li class=""><code>KEYCLOAK_CLIENT_ID=cloud-agent</code></li>
<li class=""><code>KEYCLOAK_CLIENT_SECRET=&lt;KEYCLOAK_CLIENT_SECRET&gt;</code> (replace with appropriate value)</li>
<li class=""><code>KEYCLOAK_UMA_AUTO_UPGRADE_RPT=true</code></li>
</ol>
</li>
</ol>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview" translate="no">​</a></h2>
<p>This tutorial demonstrate the process of user self-registration on Keycloak.
Then, the users can log in to Keycloak to obtain a token.
When the agent uses this token for the wallet creation, the agent recognizes it belongs to a tenant and automatically associates the tenant&#x27;s permission with the created wallet.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="endpoints">Endpoints<a href="#endpoints" class="hash-link" aria-label="Direct link to Endpoints" title="Direct link to Endpoints" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="agent-endpoints">Agent endpoints<a href="#agent-endpoints" class="hash-link" aria-label="Direct link to Agent endpoints" title="Direct link to Agent endpoints" translate="no">​</a></h3>
<table><thead><tr><th>Endpoint</th><th>Description</th><th>Role</th></tr></thead><tbody><tr><td><code>GET /wallets</code></td><td>List the wallets on the Cloud Agent</td><td>Tenant</td></tr><tr><td><code>POST /wallets</code></td><td>Create a new wallet on the Cloud Agent</td><td>Tenant</td></tr><tr><td><code>GET /did-registrar/dids</code></td><td>List the DIDs inside the wallet</td><td>Tenant</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="keycloak-endpoints">Keycloak endpoints<a href="#keycloak-endpoints" class="hash-link" aria-label="Direct link to Keycloak endpoints" title="Direct link to Keycloak endpoints" translate="no">​</a></h3>
<table><thead><tr><th>Endpoint</th><th>Description</th><th>Role</th></tr></thead><tbody><tr><td><code>POST /realms/{realm}/protocol/openid-connect/token</code></td><td>Issue a new JWT token</td><td>Tenant</td></tr></tbody></table>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="tenant-interactions">Tenant interactions<a href="#tenant-interactions" class="hash-link" aria-label="Direct link to Tenant interactions" title="Direct link to Tenant interactions" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="1-self-register-account-on-keycloak">1. Self-register account on Keycloak<a href="#1-self-register-account-on-keycloak" class="hash-link" aria-label="Direct link to 1. Self-register account on Keycloak" title="Direct link to 1. Self-register account on Keycloak" translate="no">​</a></h3>
<p>Start by registering a new account on Keycloak, accessible through its login page.
Usually, this should be available at <code>http://localhost:9980/realms/my-realm/account/</code>.</p>
<p>For detailed instructions on how to register a new user,
please refer to <a href="https://www.keycloak.org/docs/latest/server_admin/index.html#proc-registering-new-user_server_administration_guide" target="_blank" rel="noopener noreferrer" class="">registering a new user</a> section on the official documentation.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="2-obtain-access-token-from-keycloak">2. Obtain access token from Keycloak<a href="#2-obtain-access-token-from-keycloak" class="hash-link" aria-label="Direct link to 2. Obtain access token from Keycloak" title="Direct link to 2. Obtain access token from Keycloak" translate="no">​</a></h3>
<p>Once a new account is registered, Keycloak should recognize it, allowing the user to log in and obtain the access token.</p>
<p>Run this command to log in and get the access token.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -X &#x27;POST&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;http://localhost:9980/realms/my-realm/protocol/openid-connect/token&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d &quot;grant_type=password&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d &quot;client_id=admin-cli&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d &quot;username=alice&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d &quot;password=1234&quot;</span><br></span></code></pre></div></div>
<p>Make sure to use the correct username and password.
Special attention on the <code>client_id</code>; this should be the actual <code>client_id</code> of the frontend application that logs the user in.
For this tutorial, it is OK to use <code>admin-cli</code>.</p>
<p>Example token response (some fields omitted for readability)</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;access_token&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;eyJhbGciOi...7ocDHofUDQ&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;refresh_token&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;eyJhbGciOi...otsEEi4eQA&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="3-check-the-existing-wallets">3. Check the existing wallets<a href="#3-check-the-existing-wallets" class="hash-link" aria-label="Direct link to 3. Check the existing wallets" title="Direct link to 3. Check the existing wallets" translate="no">​</a></h3>
<p>Right after the account is registered, no permission should be associated with it.
Listing wallets on it should return empty results.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -X &#x27;GET&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;http://localhost:8080/cloud-agent/wallets&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -H &#x27;Authorization: Bearer eyJhbGciOi...7ocDHofUDQ&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -H &#x27;Accept: application/json&#x27;</span><br></span></code></pre></div></div>
<p>Use the correct <code>access_token</code> in the previous command&#x27;s Authorization header.</p>
<p>Response Example:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;self&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/wallets&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;kind&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;WalletPage&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;pageOf&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;/wallets&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;contents&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="4-create-a-new-wallet">4. Create a new wallet<a href="#4-create-a-new-wallet" class="hash-link" aria-label="Direct link to 4. Create a new wallet" title="Direct link to 4. Create a new wallet" translate="no">​</a></h3>
<p>Create a wallet using a <code>POST /wallets</code> endpoint.
This wallet will be a container for the tenant&#x27;s assets (DIDs, VCs, Connections, etc.).
The Agent can provide or randomly generate the wallet seed during wallet creation.</p>
<p>If the user already has the wallet associated, the wallet creation will fail as multiple wallets per tenant are not yet allowed.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -X &#x27;POST&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;http://localhost:8080/cloud-agent/wallets&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -H &#x27;Authorization: Bearer eyJhbGciOi...7ocDHofUDQ&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -H &#x27;Accept: application/json&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -H &#x27;Content-Type: application/json&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d &#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;seed&quot;: &quot;c9994785ce6d548134020f610b76102ca1075d3bb672a75ec8c9a27a7b8607e3b9b384e43b77bb08f8d5159651ae38b98573f7ecc79f2d7e1f1cc371ce60cf8a&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;name&quot;: &quot;my-wallet&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }&#x27;</span><br></span></code></pre></div></div>
<p>Response Example:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;id&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;99734c87-5c9d-4697-b5fd-dea4e9590ba7&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;name&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;my-wallet&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;createdAt&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2023-01-01T00:00:00Z&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;updatedAt&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2023-01-01T00:00:00Z&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>In this step, the agent creates both wallet resource and UMA permission on Keycloak, assigning the new wallet to the user who created it.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="5-perform-a-simple-action-to-verify-access-to-the-cloud-agent">5. Perform a simple action to verify access to the Cloud Agent<a href="#5-perform-a-simple-action-to-verify-access-to-the-cloud-agent" class="hash-link" aria-label="Direct link to 5. Perform a simple action to verify access to the Cloud Agent" title="Direct link to 5. Perform a simple action to verify access to the Cloud Agent" translate="no">​</a></h3>
<p>Without further operation, the wallet should be available for the tenant.
To prove that the tenant can access the wallet, list the DIDs using RPT in the <code>Authorization</code> header.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl --location --request GET &#x27;http://localhost:8080/cloud-agent/did-registrar/dids&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -H &#x27;Authorization: Bearer eyJhbGciOi...7ocDHofUDQ&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -H &#x27;Accept: application/json&#x27;</span><br></span></code></pre></div></div>
<p>The wallet was successfully created, but it currently does not contain any DIDs - indicated by an empty list and a 200 status.
The tenant should only perform interactions within the scope of this wallet.</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/cloud-agent/docs/docusaurus/multitenancy/tenant-onboarding-ext-iam"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Tenant Onboarding with External IAM</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/cloud-agent/docs/docusaurus/multitenancy/tenant-migration"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Migration from apikey to JWT authentication</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#roles" class="table-of-contents__link toc-highlight">Roles</a></li><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#endpoints" class="table-of-contents__link toc-highlight">Endpoints</a><ul><li><a href="#agent-endpoints" class="table-of-contents__link toc-highlight">Agent endpoints</a></li><li><a href="#keycloak-endpoints" class="table-of-contents__link toc-highlight">Keycloak endpoints</a></li></ul></li><li><a href="#tenant-interactions" class="table-of-contents__link toc-highlight">Tenant interactions</a><ul><li><a href="#1-self-register-account-on-keycloak" class="table-of-contents__link toc-highlight">1. Self-register account on Keycloak</a></li><li><a href="#2-obtain-access-token-from-keycloak" class="table-of-contents__link toc-highlight">2. Obtain access token from Keycloak</a></li><li><a href="#3-check-the-existing-wallets" class="table-of-contents__link toc-highlight">3. Check the existing wallets</a></li><li><a href="#4-create-a-new-wallet" class="table-of-contents__link toc-highlight">4. Create a new wallet</a></li><li><a href="#5-perform-a-simple-action-to-verify-access-to-the-cloud-agent" class="table-of-contents__link toc-highlight">5. Perform a simple action to verify access to the Cloud Agent</a></li></ul></li></ul></div></div></div></div></main></div></div></div><div class="container"><footer class="footer_J6tW"><svg xmlns="http://www.w3.org/2000/svg" width="145" height="38" fill="none"></svg><span class="copyright_C6JK">Hyperledger Identus CC BY 4.0</span></footer></div></div>
</body>
</html>